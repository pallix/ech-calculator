// Generated by psc version 0.10.1
"use strict";
var Prelude = require("../Prelude");
var Control_Monad_Eff = require("../Control.Monad.Eff");
var $$Math = require("../Math");
var Data_Int = require("../Data.Int");
var Data_Array = require("../Data.Array");
var DOM = require("../DOM");
var Signal_Channel = require("../Signal.Channel");
var Graphics_Canvas = require("../Graphics.Canvas");
var Control_Monad_Eff_Timer = require("../Control.Monad.Eff.Timer");
var Flare = require("../Flare");
var Graphics_Drawing = require("../Graphics.Drawing");
var Graphics_Drawing_Font = require("../Graphics.Drawing.Font");
var Signal_DOM = require("../Signal.DOM");
var Flare_Drawing = require("../Flare.Drawing");
var Control_Bind = require("../Control.Bind");
var Data_Semiring = require("../Data.Semiring");
var Data_EuclideanRing = require("../Data.EuclideanRing");
var Control_Applicative = require("../Control.Applicative");
var Data_Function = require("../Data.Function");
var Data_Foldable = require("../Data.Foldable");
var Data_Semigroup = require("../Data.Semigroup");
var Color = require("../Color");
var Data_Ring = require("../Data.Ring");
var Data_Show = require("../Data.Show");
var Control_Apply = require("../Control.Apply");
var Data_Functor = require("../Data.Functor");
var polygon = function (sides) {
    return function (col) {
        var poly = function (n) {
            return Control_Bind.bind(Control_Bind.bindArray)(Data_Array.range(0)(n))(function (v) {
                var theta = ($$Math.pi / (Data_Int.toNumber(n) / 2.0)) * Data_Int.toNumber(v);
                return Control_Applicative.pure(Control_Applicative.applicativeArray)({
                    x: 50.0 * $$Math.sin(theta), 
                    y: 50.0 * $$Math.cos(theta)
                });
            });
        };
        return Graphics_Drawing.filled(Graphics_Drawing.fillColor(col))(Graphics_Drawing.closed(Data_Foldable.foldableArray)(poly(sides)));
    };
};
var hexagon = function (col) {
    return polygon(6)(col);
};
var token = function (t) {
    return function (col) {
        return Data_Semigroup.append(Graphics_Drawing.semigroupDrawing)(hexagon(col))(Graphics_Drawing.text(Graphics_Drawing_Font.font(Graphics_Drawing_Font.sansSerif)(16)(Graphics_Drawing_Font.bold))(0.0)(0.0)(Graphics_Drawing.fillColor(Color.white))(t));
    };
};
var delta = {
    x: 200.0, 
    y: 0.0
};
var center = {
    x: 400.0, 
    y: 300.0
};
var blue = Color.rgb(0)(0)(255);
var arrow = function (v) {
    return function (t) {
        var opacity = $$Math.cos(t / 300.0) / 2.0 + 1.0;
        var arrowEnd = {
            x: (center.x + delta.x) - delta.x / 4.0, 
            y: (center.y + delta.y) - delta.y / 4.0
        };
        var arrowBegin = {
            x: (center.x - delta.x) + delta.x / 4.0, 
            y: (center.y - delta.y) + delta.y / 4.0
        };
        return Data_Semigroup.append(Graphics_Drawing.semigroupDrawing)(Graphics_Drawing.outlined(Data_Semigroup.append(Graphics_Drawing.semigroupOutlineStyle)(Graphics_Drawing.outlineColor(Color.rgba(0)(0)(255)(opacity)))(Graphics_Drawing.lineWidth(v)))(Graphics_Drawing.path(Data_Foldable.foldableArray)([ {
            x: arrowBegin.x, 
            y: arrowBegin.y
        }, {
            x: arrowEnd.x, 
            y: arrowEnd.y
        } ])))(Data_Semigroup.append(Graphics_Drawing.semigroupDrawing)(Graphics_Drawing.outlined(Data_Semigroup.append(Graphics_Drawing.semigroupOutlineStyle)(Graphics_Drawing.outlineColor(Color.rgba(0)(0)(255)(opacity)))(Graphics_Drawing.lineWidth(v)))(Graphics_Drawing.path(Data_Foldable.foldableArray)([ {
            x: arrowEnd.x - 20.0, 
            y: arrowEnd.y - 20.0
        }, {
            x: arrowEnd.x, 
            y: arrowEnd.y
        } ])))(Graphics_Drawing.outlined(Data_Semigroup.append(Graphics_Drawing.semigroupOutlineStyle)(Graphics_Drawing.outlineColor(Color.rgba(0)(0)(255)(opacity)))(Graphics_Drawing.lineWidth(v)))(Graphics_Drawing.path(Data_Foldable.foldableArray)([ {
            x: arrowEnd.x - 20.0, 
            y: arrowEnd.y + 20.0
        }, {
            x: arrowEnd.x, 
            y: arrowEnd.y
        } ]))));
    };
};
var foodToBin = function (v) {
    return function (t) {
        var translateRight = Graphics_Drawing.translate(center.x + delta.x)(center.y + delta.y);
        var translateLeft = Graphics_Drawing.translate(center.x - delta.x)(center.y - delta.y);
        return Data_Semigroup.append(Graphics_Drawing.semigroupDrawing)(translateLeft(token("Food")(blue)))(Data_Semigroup.append(Graphics_Drawing.semigroupDrawing)(translateRight(token("Bin")(blue)))(Data_Semigroup.append(Graphics_Drawing.semigroupDrawing)(arrow(v)(t))(Graphics_Drawing.text(Graphics_Drawing_Font.font(Graphics_Drawing_Font.sansSerif)(16)(Graphics_Drawing_Font.bold))(center.x)(center.y - 10.0)(Graphics_Drawing.fillColor(blue))(Data_Show.show(Data_Show.showNumber)(v)))));
    };
};
var ui = Control_Apply.apply(Flare.applyUI)(Data_Functor.map(Flare.functorUI)(foodToBin)(Flare.numberSlider("value")(0.0)(10.0)(1.0)(7.0)))(Flare.lift(Signal_DOM.animationFrame));
var main = Flare_Drawing.runFlareDrawing("controls")("output")(ui);
module.exports = {
    arrow: arrow, 
    blue: blue, 
    center: center, 
    delta: delta, 
    foodToBin: foodToBin, 
    hexagon: hexagon, 
    main: main, 
    polygon: polygon, 
    token: token, 
    ui: ui
};
